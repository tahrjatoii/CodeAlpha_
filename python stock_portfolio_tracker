"""
================================================
  ğŸ“ˆ  Stock Portfolio Tracker
================================================
  - Hardcoded stock prices (dictionary)
  - User adds stocks & quantities interactively
  - Displays a formatted portfolio summary
  - Saves results to portfolio_report.csv
================================================
"""

import csv
import os
from datetime import datetime

# â”€â”€â”€ Hardcoded stock price dictionary (USD) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
STOCK_PRICES = {
    "AAPL":  180.00,   # Apple
    "TSLA":  250.00,   # Tesla
    "GOOGL": 140.00,   # Alphabet (Google)
    "MSFT":  375.00,   # Microsoft
    "AMZN":  185.00,   # Amazon
    "NVDA":  875.00,   # NVIDIA
    "META":  505.00,   # Meta (Facebook)
    "NFLX":  625.00,   # Netflix
    "BRK":   380.00,   # Berkshire Hathaway
    "JPM":   198.00,   # JPMorgan Chase
}

DIVIDER  = "â”€" * 54
DIVIDER2 = "â•" * 54


# â”€â”€â”€ Helper: Show all available tickers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def show_available_stocks():
    print(f"\n{'  Ticker':<12} {'Company':<22} {'Price (USD)':>12}")
    print(DIVIDER)
    companies = {
        "AAPL": "Apple",         "TSLA": "Tesla",
        "GOOGL": "Alphabet",     "MSFT": "Microsoft",
        "AMZN": "Amazon",        "NVDA": "NVIDIA",
        "META": "Meta",          "NFLX": "Netflix",
        "BRK":  "Berkshire H.",  "JPM":  "JPMorgan Chase",
    }
    for ticker, price in STOCK_PRICES.items():
        print(f"  {ticker:<10} {companies[ticker]:<22} ${price:>10,.2f}")
    print(DIVIDER)


# â”€â”€â”€ Helper: Print the portfolio summary table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def print_summary(portfolio):
    print(f"\n\n{'  PORTFOLIO SUMMARY':^54}")
    print(DIVIDER2)
    print(f"  {'Stock':<8} {'Qty':>6}  {'Price':>10}  {'Value':>12}")
    print(DIVIDER)

    total = 0.0
    rows  = []   # for CSV export

    for ticker, qty in portfolio.items():
        price = STOCK_PRICES[ticker]
        value = price * qty
        total += value
        print(f"  {ticker:<8} {qty:>6}  ${price:>9,.2f}  ${value:>11,.2f}")
        rows.append((ticker, qty, price, value))

    print(DIVIDER)
    print(f"  {'TOTAL INVESTMENT':>27}  ${total:>11,.2f}")
    print(DIVIDER2 + "\n")

    return rows, total


# â”€â”€â”€ Helper: Save report to CSV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def save_to_csv(rows, total, filename="portfolio_report.csv"):
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

    with open(filename, "w", newline="") as f:
        writer = csv.writer(f)
        writer.writerow(["Stock Portfolio Report"])
        writer.writerow(["Generated:", timestamp])
        writer.writerow([])
        writer.writerow(["Ticker", "Quantity", "Price (USD)", "Value (USD)"])
        for ticker, qty, price, value in rows:
            writer.writerow([ticker, qty, f"{price:.2f}", f"{value:.2f}"])
        writer.writerow([])
        writer.writerow(["", "", "TOTAL", f"{total:.2f}"])

    print(f"  âœ”  Report saved to  â†’  {os.path.abspath(filename)}\n")


# â”€â”€â”€ Helper: Save report to TXT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def save_to_txt(rows, total, filename="portfolio_report.txt"):
    timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    line      = DIVIDER

    with open(filename, "w") as f:
        f.write("=" * 54 + "\n")
        f.write("        STOCK PORTFOLIO REPORT\n")
        f.write(f"        Generated: {timestamp}\n")
        f.write("=" * 54 + "\n\n")
        f.write(f"  {'Stock':<8} {'Qty':>6}  {'Price':>10}  {'Value':>12}\n")
        f.write(line + "\n")
        for ticker, qty, price, value in rows:
            f.write(f"  {ticker:<8} {qty:>6}  ${price:>9,.2f}  ${value:>11,.2f}\n")
        f.write(line + "\n")
        f.write(f"  {'TOTAL INVESTMENT':>27}  ${total:>11,.2f}\n")
        f.write("=" * 54 + "\n")

    print(f"  âœ”  Report saved to  â†’  {os.path.abspath(filename)}\n")


# â”€â”€â”€ Main application â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def main():
    portfolio = {}   # { "AAPL": 10, "TSLA": 5, ... }

    print("\n" + DIVIDER2)
    print("        ğŸ“ˆ  STOCK PORTFOLIO TRACKER")
    print(DIVIDER2)
    print("  Track your investments using real-time-like prices.")

    while True:
        print("\n  â”€â”€ MENU â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€")
        print("  [1]  Add / update a stock")
        print("  [2]  Remove a stock")
        print("  [3]  View available stocks & prices")
        print("  [4]  View portfolio summary")
        print("  [5]  Save report  (CSV)")
        print("  [6]  Save report  (TXT)")
        print("  [7]  Quit")
        print("  " + DIVIDER)

        choice = input("  Enter choice (1-7): ").strip()

        # â”€â”€ Add / update stock â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if choice == "1":
            ticker = input("\n  Enter stock ticker (e.g. AAPL): ").strip().upper()
            if ticker not in STOCK_PRICES:
                print(f"  âœ˜  '{ticker}' not found. Choose from: {', '.join(STOCK_PRICES)}")
                continue
            try:
                qty = int(input(f"  Enter quantity for {ticker}: ").strip())
                if qty <= 0:
                    print("  âœ˜  Quantity must be a positive integer.")
                    continue
            except ValueError:
                print("  âœ˜  Invalid quantity. Please enter a whole number.")
                continue

            action = "Updated" if ticker in portfolio else "Added"
            portfolio[ticker] = qty
            price = STOCK_PRICES[ticker]
            print(f"  âœ”  {action}: {qty} Ã— {ticker} @ ${price:,.2f} = ${price * qty:,.2f}")

        # â”€â”€ Remove stock â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "2":
            if not portfolio:
                print("  âš   Your portfolio is empty.")
                continue
            ticker = input("\n  Enter ticker to remove: ").strip().upper()
            if ticker in portfolio:
                del portfolio[ticker]
                print(f"  âœ”  {ticker} removed from portfolio.")
            else:
                print(f"  âœ˜  {ticker} is not in your portfolio.")

        # â”€â”€ View available stocks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "3":
            show_available_stocks()

        # â”€â”€ View portfolio summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "4":
            if not portfolio:
                print("\n  âš   Your portfolio is empty. Add some stocks first.")
                continue
            print_summary(portfolio)

        # â”€â”€ Save CSV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "5":
            if not portfolio:
                print("\n  âš   Nothing to save. Add some stocks first.")
                continue
            rows, total = print_summary(portfolio)
            save_to_csv(rows, total)

        # â”€â”€ Save TXT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "6":
            if not portfolio:
                print("\n  âš   Nothing to save. Add some stocks first.")
                continue
            rows, total = print_summary(portfolio)
            save_to_txt(rows, total)

        # â”€â”€ Quit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        elif choice == "7":
            if portfolio:
                rows, total = print_summary(portfolio)
                save = input("  Save a final report before quitting? (y/n): ").strip().lower()
                if save == "y":
                    fmt = input("  Format â€” CSV or TXT? (c/t): ").strip().lower()
                    if fmt == "t":
                        save_to_txt(rows, total)
                    else:
                        save_to_csv(rows, total)
            print("\n  ğŸ‘‹  Thanks for using Stock Portfolio Tracker. Goodbye!\n")
            break

        else:
            print("  âœ˜  Invalid option. Please enter a number from 1 to 7.")


# â”€â”€â”€ Entry point â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if __name__ == "__main__":
    main()
